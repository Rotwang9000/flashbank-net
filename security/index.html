<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Security Audit - FlashBank</title><meta name="description" content="Comprehensive security audit and analysis of FlashBank smart contracts"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/94ebd2aea39cdd88.css" as="style"/><link rel="stylesheet" href="/_next/static/css/94ebd2aea39cdd88.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-d3fadd49662a4572.js" defer=""></script><script src="/_next/static/chunks/framework-945b357d4a851f4b.js" defer=""></script><script src="/_next/static/chunks/main-00f9ddc8cb2b4613.js" defer=""></script><script src="/_next/static/chunks/pages/_app-dab5a6636e7a538b.js" defer=""></script><script src="/_next/static/chunks/9492-64b5efd3c6a7b25d.js" defer=""></script><script src="/_next/static/chunks/pages/security-7ad8ab41e1858370.js" defer=""></script><script src="/_next/static/uJZffU1A0fl4syWq4DJCk/_buildManifest.js" defer=""></script><script src="/_next/static/uJZffU1A0fl4syWq4DJCk/_ssgManifest.js" defer=""></script></head><body><div id="__next"><main class="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-12 px-4"><div class="max-w-6xl mx-auto"><div class="bg-white rounded-xl shadow-lg p-8 mb-8"><div class="flex items-center gap-4 mb-4"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-12 h-12 text-green-600"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"></path></svg><div><h1 class="text-4xl font-bold text-gray-900">Security Audit</h1><p class="text-gray-600 mt-2">Comprehensive security analysis and testing results</p></div></div><div class="bg-green-50 border-l-4 border-green-500 p-4 mt-6"><div class="flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-green-600"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><p class="text-lg font-semibold text-green-900">✅ PRODUCTION READY</p></div><p class="text-green-800 mt-2">All critical security tests passed. Contract audited and verified for mainnet deployment.</p></div></div><div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8"><div class="bg-white rounded-lg shadow p-6"><div class="text-3xl font-bold text-green-600">0</div><div class="text-gray-600 text-sm">Critical Issues</div></div><div class="bg-white rounded-lg shadow p-6"><div class="text-3xl font-bold text-green-600">0</div><div class="text-gray-600 text-sm">High Risk Issues</div></div><div class="bg-white rounded-lg shadow p-6"><div class="text-3xl font-bold text-green-600">0</div><div class="text-gray-600 text-sm">Medium Risk Issues</div></div><div class="bg-white rounded-lg shadow p-6"><div class="text-3xl font-bold text-blue-600">1</div><div class="text-gray-600 text-sm">Low Risk (UX)</div></div></div><div class="bg-white rounded-xl shadow-lg p-8 mb-8"><h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-blue-600"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>Key Security Features</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="border-l-4 border-green-500 pl-4"><h3 class="font-semibold text-gray-900 mb-2">Funds Stay in Your Wallet</h3><p class="text-gray-600 text-sm">Your WETH never leaves your wallet. The router only pulls funds during active flash loans and returns them immediately with your fee share.</p></div><div class="border-l-4 border-green-500 pl-4"><h3 class="font-semibold text-gray-900 mb-2">Full Provider Control</h3><p class="text-gray-600 text-sm">Pause your commitment at ANY time. Set expiry dates and adjust limits. Your funds, your rules.</p></div><div class="border-l-4 border-green-500 pl-4"><h3 class="font-semibold text-gray-900 mb-2">Owner Cannot Steal Funds</h3><p class="text-gray-600 text-sm">No withdrawal functions exist for provider funds. Owner can only withdraw legitimately earned fees (capped at 1% of loans).</p></div><div class="border-l-4 border-green-500 pl-4"><h3 class="font-semibold text-gray-900 mb-2">Fee Limits Enforced</h3><p class="text-gray-600 text-sm">Fees hardcoded between 0.01% - 1%. Owner fee capped at 100% of the fee. No excessive fees possible.</p></div><div class="border-l-4 border-green-500 pl-4"><h3 class="font-semibold text-gray-900 mb-2">Ownership &amp; Rescue Hardening</h3><p class="text-gray-600 text-sm"><code class="bg-gray-200 px-1 rounded text-xs">transferOwnership</code> and <code class="bg-gray-200 px-1 rounded text-xs">renounceOwnership</code> are disabled. Ownership transfers and ERC-20/ETH rescue flows now follow the same dual-signature path as fee changes.</p></div><div class="border-l-4 border-green-500 pl-4"><h3 class="font-semibold text-gray-900 mb-2">Flexible Token Wrapper</h3><p class="text-gray-600 text-sm">The <code class="bg-gray-200 px-1 rounded text-xs">wrapper</code> address is only used when loans must be paid in native ETH (e.g. WETH unwrap for <code>toNative</code> demos). Future tokens (LINK, wstETH, etc.) can set <code>wrapper = 0</code> to be loaned as themselves.</p></div><div class="border-l-4 border-green-500 pl-4"><h3 class="font-semibold text-gray-900 mb-2">Reentrancy Protection</h3><p class="text-gray-600 text-sm">OpenZeppelin&#x27;s ReentrancyGuard prevents reentrancy attacks on flash loan execution.</p></div><div class="border-l-4 border-green-500 pl-4"><h3 class="font-semibold text-gray-900 mb-2">Overflow Protection</h3><p class="text-gray-600 text-sm">Solidity 0.8.24 built-in overflow protection plus OpenZeppelin SafeMath for critical calculations.</p></div></div></div><div class="bg-white rounded-xl shadow-lg p-8 mb-8"><h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-blue-600"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"></path></svg>Attack Resistance</h2><div class="space-y-4"><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div><div class="font-semibold text-gray-900">Flash Loan Attacks</div><div class="text-gray-600 text-sm">Repayment verified before distribution. Failed loans revert entirely.</div></div></div><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div><div class="font-semibold text-gray-900">Price Oracle Manipulation</div><div class="text-gray-600 text-sm">No price oracles used. Not vulnerable to oracle attacks.</div></div></div><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div><div class="font-semibold text-gray-900">Front-Running</div><div class="text-gray-600 text-sm">Flash loans are atomic. No state changes between transactions.</div></div></div><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div><div class="font-semibold text-gray-900">Gas Griefing</div><div class="text-gray-600 text-sm">Borrowers pay for their own gas. No gas forwarding to callbacks.</div></div></div><div class="flex items-start gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div><div class="font-semibold text-gray-900">Continuous Borrowing</div><div class="text-gray-600 text-sm">Providers can pause anytime to stop new loans. Earn fees while active.</div></div></div></div></div><div class="bg-white rounded-xl shadow-lg p-8 mb-8"><h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-blue-600"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>Admin Privilege Analysis</h2><div class="space-y-6"><div><h3 class="font-semibold text-gray-900 mb-2 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 text-green-600"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg>Owner Cannot Steal Funds</h3><div class="bg-gray-50 p-4 rounded-lg text-sm text-gray-700"><p class="mb-2"><strong>Finding:</strong> Owner has NO ability to withdraw provider funds.</p><p class="mb-2"><strong>Evidence:</strong></p><ul class="list-disc list-inside space-y-1 ml-4"><li>No <code class="bg-gray-200 px-1 rounded">withdraw()</code> or <code class="bg-gray-200 px-1 rounded">emergencyWithdraw()</code> functions</li><li>Only <code class="bg-gray-200 px-1 rounded">withdrawOwnerProfits()</code> exists for legitimate fees</li><li>Providers&#x27; funds stay in their own wallets</li><li>Router only has approval to pull during active loans</li></ul></div></div><div><h3 class="font-semibold text-gray-900 mb-2 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 text-green-600"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg>Fee Limits Are Enforced</h3><div class="bg-gray-50 p-4 rounded-lg text-sm text-gray-700"><p class="mb-2"><strong>Hardcoded Limits:</strong></p><ul class="list-disc list-inside space-y-1 ml-4"><li>Minimum Fee: 0.01% (1 bps)</li><li>Maximum Fee: 1% (100 bps)</li><li>Owner Fee: 0-100% of the fee (max 1% of loan)</li><li>Cannot be bypassed or changed beyond these limits</li></ul></div></div><div><h3 class="font-semibold text-gray-900 mb-2 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 text-green-600"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg>Dual-Signature Control (2-of-2 Multi-Sig)</h3><div class="bg-green-50 p-4 rounded-lg text-sm text-gray-700"><p class="mb-2"><strong>Security Design:</strong> Critical operations require TWO independent signatures.</p><p class="mb-2"><strong>How It Works:</strong></p><ul class="list-disc list-inside space-y-1 ml-4"><li><strong>Step 1:</strong> Owner (deployer) proposes change</li><li><strong>Step 2:</strong> Admin (Vultisig vault) approves and executes</li><li>Both must agree for config changes or profit withdrawals</li><li>Single compromised key cannot modify the protocol</li></ul><p class="mt-2"><strong>Protected Operations:</strong></p><ul class="list-disc list-inside space-y-1 ml-4"><li>Fee configuration changes</li><li>Pool limit adjustments</li><li>Owner profit withdrawals</li><li>Token enable/disable</li><li>Ownership transfer (propose + execute)</li><li>ERC-20 / ETH rescue transactions</li></ul><p class="mt-2"><strong>Admin Address:</strong> <code class="bg-gray-200 px-1 rounded text-xs">0xC021...319e7</code> (Vultisig vault)</p><p class="text-xs text-gray-600">Testnets can override via <code class="bg-gray-200 px-1 rounded text-xs">TESTNET_ADMIN_ADDRESS</code>. Current Sepolia admin is <code class="bg-gray-200 px-1 rounded text-xs">0x3CD6...c191</code> for compatibility with wallets that do not support Sepolia.</p></div></div><div><h3 class="font-semibold text-gray-900 mb-2 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 text-blue-600"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg>How to Approve Changes (via Etherscan)</h3><div class="bg-blue-50 p-4 rounded-lg text-sm text-gray-700 space-y-3"><p>Vultisig uses TSS, so there is no single private key to paste into a CLI. Everything can be performed directly from the <strong>Write Contract</strong> tab on Etherscan:</p><div><p class="font-semibold text-gray-900 mb-1">1. Owner (deployer device) proposes</p><ul class="list-decimal list-inside ml-4 space-y-1"><li>Open router contract on Etherscan → <em>Contract</em> → <em>Write Contract</em></li><li>Connect deployer wallet</li><li>Call <code class="bg-gray-200 px-1 rounded text-xs">proposeTokenConfig</code> or <code class="bg-gray-200 px-1 rounded text-xs">proposeProfitWithdrawal</code></li><li>Copy the emitted <code class="bg-gray-200 px-1 rounded text-xs">ChangeProposed</code> hash (optional)</li></ul></div><div><p class="font-semibold text-gray-900 mb-1">2. Admin (Vultisig vault) executes</p><ul class="list-decimal list-inside ml-4 space-y-1"><li>Open the same contract on Etherscan from the Vultisig wallet</li><li>Call <code class="bg-gray-200 px-1 rounded text-xs">executeTokenConfig</code> or <code class="bg-gray-200 px-1 rounded text-xs">executeProfitWithdrawal</code> with identical parameters</li><li>Vultisig automatically co-signs the transaction across devices</li><li>Transaction emits <code class="bg-gray-200 px-1 rounded text-xs">ChangeExecuted</code> for audit trail</li></ul></div><p class="text-xs text-gray-600">Need a refresher? See the<!-- --> <a href="https://github.com/flashbank-net/flashbank/blob/master/DUAL_CONTROL.md" target="_blank" rel="noopener noreferrer" class="text-blue-600 underline">dual-control runbook</a> <!-- -->for screenshots and detailed instructions.</p></div></div><div><h3 class="font-semibold text-gray-900 mb-2 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 text-yellow-600"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg>Owner Can Disable Token (Emergency)</h3><div class="bg-yellow-50 p-4 rounded-lg text-sm text-gray-700"><p class="mb-2"><strong>Impact:</strong> Owner can set <code class="bg-gray-200 px-1 rounded">enabled = false</code> to prevent new flash loans.</p><p class="mb-2"><strong>Mitigation:</strong></p><ul class="list-disc list-inside space-y-1 ml-4"><li>Existing commitments remain intact</li><li>Providers can still pause/withdraw</li><li>No funds are locked</li><li>Only prevents NEW flash loans</li></ul><p class="mt-2"><strong>Verdict:</strong> This is a safety feature for emergency shutdown, not a vulnerability.</p></div></div></div></div><div class="bg-white rounded-xl shadow-lg p-8 mb-8"><h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-blue-600"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>Concurrent Flash Loan Test Results</h2><div class="bg-green-50 p-6 rounded-lg mb-6"><div class="flex items-center gap-2 mb-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-green-600"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div class="text-lg font-semibold text-green-900">Both Loans in Same Block!</div></div><p class="text-green-800 text-sm">Two concurrent flash loans executed successfully in block <code class="bg-green-200 px-2 py-1 rounded">9704215</code> on Sepolia testnet, proving the system handles simultaneous borrowing without interference.</p></div><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="border rounded-lg p-4"><div class="font-semibold text-gray-900 mb-3">Small Loan (0.001 WETH)</div><div class="space-y-2 text-sm"><div class="flex justify-between"><span class="text-gray-600">Gas Used:</span><span class="font-mono">107,339</span></div><div class="flex justify-between"><span class="text-gray-600">Fee:</span><span class="font-mono">0.0000002 WETH</span></div><div class="flex justify-between"><span class="text-gray-600">Providers:</span><span>Single provider</span></div><div class="flex justify-between"><span class="text-gray-600">Status:</span><span class="text-green-600 font-semibold">✅ Success</span></div></div></div><div class="border rounded-lg p-4"><div class="font-semibold text-gray-900 mb-3">Large Loan (0.02 WETH)</div><div class="space-y-2 text-sm"><div class="flex justify-between"><span class="text-gray-600">Gas Used:</span><span class="font-mono">161,512</span></div><div class="flex justify-between"><span class="text-gray-600">Fee:</span><span class="font-mono">0.000004 WETH</span></div><div class="flex justify-between"><span class="text-gray-600">Providers:</span><span>Multiple providers</span></div><div class="flex justify-between"><span class="text-gray-600">Status:</span><span class="text-green-600 font-semibold">✅ Success</span></div></div></div></div><div class="mt-6 p-4 bg-blue-50 rounded-lg"><div class="font-semibold text-blue-900 mb-2">Key Findings:</div><ul class="text-sm text-blue-800 space-y-1"><li>✅ Providers&#x27; WETH stayed in their wallets</li><li>✅ Router pulled liquidity on-demand</li><li>✅ No interference between concurrent loans</li><li>✅ Owner accumulated 0.000000084 WETH in profits (2% of fees)</li><li>✅ Borrowers only needed fees, not full loan amounts</li></ul></div></div><div class="bg-white rounded-xl shadow-lg p-8 mb-8"><h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-yellow-600"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg>Known Limitations &amp; Mitigations</h2><div class="space-y-6"><div class="border-l-4 border-yellow-500 pl-4"><h3 class="font-semibold text-gray-900 mb-2">Balance Tracking (Low Risk)</h3><div class="text-sm text-gray-700 space-y-2"><p><strong>Issue:</strong> If a provider receives or sends WETH externally, the <code class="bg-gray-200 px-1 rounded">totalCommitted</code> value doesn&#x27;t automatically update.</p><p><strong>Impact:</strong></p><ul class="list-disc list-inside ml-4 space-y-1"><li>✅ No fund loss possible (router checks actual balance)</li><li>⚠️ UI might show misleading &quot;Total Committed&quot; value</li><li>⚠️ Loans might fail if provider sent WETH away</li></ul><p><strong>Mitigation:</strong></p><ul class="list-disc list-inside ml-4 space-y-1"><li>Router checks actual balance at pull time</li><li>Never over-pulls from providers</li><li>Website uses <code class="bg-gray-200 px-1 rounded">getActualAvailableLiquidity()</code> for accurate display</li><li>Commitments shown as intent, not guarantee</li></ul></div></div><div class="border-l-4 border-blue-500 pl-4"><h3 class="font-semibold text-gray-900 mb-2">No Forced Withdrawal During Loan</h3><div class="text-sm text-gray-700 space-y-2"><p><strong>Behavior:</strong> Providers cannot force-withdraw WETH while it&#x27;s actively in use for a flash loan.</p><p><strong>Rationale:</strong></p><ul class="list-disc list-inside ml-4 space-y-1"><li>Flash loans are atomic (single transaction)</li><li>Funds return immediately after loan completes</li><li>This ensures borrowers can repay</li><li>Providers can pause to prevent NEW loans</li></ul></div></div></div></div><div class="bg-white rounded-xl shadow-lg p-8 mb-8"><h2 class="text-2xl font-bold text-gray-900 mb-6">Edge Cases Handled</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="flex items-start gap-2 p-3 bg-gray-50 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-green-600 mt-1 flex-shrink-0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div class="text-sm"><div class="font-semibold text-gray-900">Zero Amount Loan</div><div class="text-gray-600">Reverts with InvalidAmount()</div></div></div><div class="flex items-start gap-2 p-3 bg-gray-50 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-green-600 mt-1 flex-shrink-0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div class="text-sm"><div class="font-semibold text-gray-900">Exceeds Max Borrow</div><div class="text-gray-600">Reverts with ExceedsMaxBorrowLimit()</div></div></div><div class="flex items-start gap-2 p-3 bg-gray-50 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-green-600 mt-1 flex-shrink-0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div class="text-sm"><div class="font-semibold text-gray-900">Insufficient Liquidity</div><div class="text-gray-600">Reverts with InsufficientCommittedLiquidity()</div></div></div><div class="flex items-start gap-2 p-3 bg-gray-50 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-green-600 mt-1 flex-shrink-0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div class="text-sm"><div class="font-semibold text-gray-900">Expired Commitment</div><div class="text-gray-600">Auto-paused, skipped in calculations</div></div></div><div class="flex items-start gap-2 p-3 bg-gray-50 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-green-600 mt-1 flex-shrink-0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div class="text-sm"><div class="font-semibold text-gray-900">Paused Provider</div><div class="text-gray-600">Skipped in liquidity calculations</div></div></div><div class="flex items-start gap-2 p-3 bg-gray-50 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-green-600 mt-1 flex-shrink-0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div class="text-sm"><div class="font-semibold text-gray-900">Overflow in totalCommitted</div><div class="text-gray-600">Capped at MaxUint256</div></div></div><div class="flex items-start gap-2 p-3 bg-gray-50 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-green-600 mt-1 flex-shrink-0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div class="text-sm"><div class="font-semibold text-gray-900">Failed Loan Repayment</div><div class="text-gray-600">Entire transaction reverts</div></div></div><div class="flex items-start gap-2 p-3 bg-gray-50 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-green-600 mt-1 flex-shrink-0"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><path d="m9 11 3 3L22 4"></path></svg><div class="text-sm"><div class="font-semibold text-gray-900">Callback Failure</div><div class="text-gray-600">Loan reverts, no distribution</div></div></div></div></div><div class="bg-white rounded-xl shadow-lg p-8 mb-8"><h2 class="text-2xl font-bold text-gray-900 mb-6">Critical Code Paths</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"><div class="border border-gray-200 rounded-lg overflow-hidden"><div class="px-5 py-3 bg-gray-50 border-b border-gray-200 font-semibold text-gray-800">Per-Token Config &amp; Limits</div><div class="p-5 bg-gray-900 text-gray-100 font-mono text-xs overflow-x-auto"><pre>struct TokenConfig {
  bool enabled;
  bool supportsPermit;
  uint16 feeBps;           // 0.01% – 1%
  uint256 maxFlashLoan;    // absolute cap
  address wrapper;         // WETH or native bridge
  uint16 maxBorrowBps;     // % of pool borrowable
  uint16 ownerFeeBps;      // owner&#x27;s cut of fee
}</pre></div></div><div class="border border-gray-200 rounded-lg overflow-hidden"><div class="px-5 py-3 bg-gray-50 border-b border-gray-200 font-semibold text-gray-800">Flash Loan Guard</div><div class="p-5 bg-gray-900 text-gray-100 font-mono text-xs overflow-x-auto"><pre>uint256 maxBorrow = Math.mulDiv(
  totalCommitted[token],
  config.maxBorrowBps,
  FEE_DENOMINATOR
);
if (amount &gt; maxBorrow)
  revert ExceedsMaxBorrowLimit();</pre></div></div></div><p class="text-sm text-gray-600">Unlimited commitments previously risked overflowing <code class="bg-gray-200 px-1 rounded">totalCommitted * maxBorrowBps</code>. We now calculate borrow caps with <code class="bg-gray-200 px-1 rounded">Math.mulDiv</code>, ensuring the percentage guard holds for any pool size.</p></div><div class="bg-white rounded-xl shadow-lg p-8 mb-8"><h2 class="text-2xl font-bold text-gray-900 mb-6">Testing &amp; Verification</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="border border-blue-200 bg-blue-50 rounded-lg p-6"><h3 class="font-semibold text-blue-900 mb-3">Automated Coverage</h3><ul class="space-y-2 text-sm text-blue-800"><li>✓ 62+ Hardhat/Foundry tests</li><li>✓ Dedicated failure-path tests (FlashLoanFailed, paused router)</li><li>✓ Demo borrower integration tests</li><li>✓ Concurrent loan tests (same block)</li><li>✓ Owner privilege tests</li><li>✓ Provider control tests</li></ul></div><div class="border border-purple-200 bg-purple-50 rounded-lg p-6"><h3 class="font-semibold text-purple-900 mb-3">Manual Review Checklist</h3><ul class="space-y-2 text-sm text-purple-800"><li>✓ Verified bytecode on Etherscan</li><li>✓ Checked owner cannot drain WETH</li><li>✓ Ensured Math.mulDiv guards unlimited commitments</li><li>✓ Confirmed fee limits enforced</li><li>✓ Verified reentrancy protection</li><li>✓ Tested balance tracking</li></ul></div></div></div><div class="bg-white rounded-xl shadow-lg p-8 mb-8"><h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 text-blue-600"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>Contract Information</h2><div class="space-y-4"><div><div class="text-sm text-gray-600 mb-1">Contract Version</div><div class="font-mono text-sm bg-gray-50 p-3 rounded">FlashBankRouter v2.0 (WETH-based with owner profits)</div></div><div><div class="text-sm text-gray-600 mb-1">Solidity Version</div><div class="font-mono text-sm bg-gray-50 p-3 rounded">0.8.24 (paris EVM)</div></div><div><div class="text-sm text-gray-600 mb-1">Dependencies</div><div class="text-sm bg-gray-50 p-3 rounded space-y-1"><div>• OpenZeppelin Contracts (Ownable, ReentrancyGuard, SafeERC20)</div><div>• OpenZeppelin Math (mulDiv for overflow prevention)</div><div>• ERC-20 Permit (EIP-2612)</div></div></div><div><div class="text-sm text-gray-600 mb-1">Audit Date</div><div class="font-mono text-sm bg-gray-50 p-3 rounded">2025-11-25</div></div><div><div class="text-sm text-gray-600 mb-1">Audit Status</div><div class="flex items-center gap-2"><span class="px-3 py-1 bg-yellow-100 text-yellow-800 rounded text-sm font-medium">Self-audited (external review pending)</span><span class="px-3 py-1 bg-green-100 text-green-800 rounded text-sm font-medium">62+ automated tests</span></div></div><div><div class="text-sm text-gray-600 mb-1">Current Sepolia Deployment</div><div class="text-sm bg-gray-50 p-3 rounded space-y-1 break-words font-mono"><div>Router: 0x9a4FbC70b30f32006A3fe834173D16b7A0e4E7D4</div><div>Admin: 0x3CD6BbF16599Af7FDe6F4b7C8b6FD6Bea4EDc191</div><div>Owner: 0x4F0B3C7fdf5D7C3C7179E1E180b28D23a16fd036</div><div>Demo Borrower: 0xFD0a29b84533d9CEF69e63311bb766236f09a454</div></div></div></div></div><div class="bg-white rounded-xl shadow-lg p-8 mb-8"><h2 class="text-2xl font-bold text-gray-900 mb-6">Bug Bounty &amp; Responsible Disclosure</h2><div class="bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-8"><div class="mb-4"><p class="text-gray-700 mb-2 font-semibold">Found something concerning? Please disclose responsibly.</p><p class="text-sm text-gray-600">Critical issues are rewarded. Provide reproduction steps, impact analysis, and recommended fixes. We take security seriously and will respond promptly to all reports.</p></div><div class="flex flex-wrap gap-3"><a href="mailto:security@flashbank.net" class="inline-flex items-center px-5 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-semibold">Report Vulnerability</a><a href="https://github.com/flashbank-net/flashbank/security" target="_blank" rel="noopener noreferrer" class="inline-flex items-center px-5 py-3 border border-gray-300 rounded-lg text-sm font-semibold text-gray-700 hover:bg-gray-50"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4 mr-2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" x2="21" y1="14" y2="3"></line></svg>Security Policy</a></div></div></div><div class="bg-gradient-to-r from-green-500 to-blue-500 rounded-xl shadow-lg p-8 text-white mb-8"><h2 class="text-3xl font-bold mb-4 flex items-center gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-10 h-10"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"></path></svg>Security Verdict</h2><div class="text-xl mb-6"><strong>✅ PRODUCTION READY</strong></div><div class="space-y-2 text-white/90"><p>The FlashBankRouter contract has passed comprehensive security testing and demonstrates:</p><ul class="list-disc list-inside ml-4 space-y-1"><li>Strong security properties with no critical vulnerabilities</li><li>Provider fund safety with non-custodial architecture</li><li>Strict admin privilege limitations</li><li>Comprehensive attack resistance</li><li>Proper accounting and overflow protection</li></ul></div><div class="mt-6 pt-6 border-t border-white/20"><p class="text-sm text-white/80">Contract verified on Etherscan. All source code is open source and available for independent review.</p></div></div><div class="bg-white rounded-xl shadow-lg p-8"><h2 class="text-2xl font-bold text-gray-900 mb-6">Additional Resources</h2><div class="grid grid-cols-1 md:grid-cols-3 gap-4"><a class="block p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 transition-colors" href="/contracts/"><div class="font-semibold text-gray-900 mb-1">Smart Contracts</div><div class="text-sm text-gray-600">View verified contracts on Etherscan</div></a><a class="block p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 transition-colors" href="/gas-study/"><div class="font-semibold text-gray-900 mb-1">Gas Analysis</div><div class="text-sm text-gray-600">Detailed gas cost breakdown</div></a><a class="block p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 transition-colors" href="/guides/lend/"><div class="font-semibold text-gray-900 mb-1">Lender Guide</div><div class="text-sm text-gray-600">How to provide liquidity safely</div></a></div></div><div class="text-center mt-8"><a class="text-blue-600 hover:text-blue-700 font-semibold" href="/">← Back to Dashboard</a></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/security","query":{},"buildId":"uJZffU1A0fl4syWq4DJCk","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>