(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9708],{79058:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/security-audit",function(){return s(21996)}])},21996:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var r=s(85893);s(67294);var a=s(9008),l=s.n(a),i=s(41664),n=s.n(i),o=s(73416),d=s(39200),c=s(60493),m=s(82126),x=s(2553),h=s(71707),u=s(91892);let p=[{title:"Wallet-Custodied Liquidity",detail:"Providers keep WETH in their own wallets. The router can only pull funds for the duration of a flash loan and must return the exact amount plus fee before the transaction ends."},{title:"Fee & Borrow Clamps",detail:"Per-token fee must stay between 0.01% and 1%. Each flash loan can draw at most a configurable percentage of the total pool (default 50%), preventing whale monopolisation."},{title:"Permit + Allowance Safety",detail:"Providers may use ERC-20 permit or standard approval. Commitment state lives entirely on-chain, so changing wallets or revoking approvals leaves no hidden liabilities."},{title:"FlashLoanFailed Guard",detail:"If the borrower fails to repay principal + fee in the same transaction, the router reverts everything. Providers’ balances never change on a failed borrow."}],g=[{title:"Unlimited Commitment Overflow",impact:"Medium",detail:"Summing unlimited commitments could overflow when calculating maxBorrowBps. Fixed in v2 by switching to OpenZeppelin Math.mulDiv for safe percentage math."},{title:"Demo Theft Proof",impact:"Low",detail:"Fail demo now intentionally reverts on mainnet and the UI records it as an expected “blocked” borrow instead of surfacing a scary error."}],b=[{title:"No External Audit Yet",detail:"This is a self-audited release. We encourage independent audits before mainnet liquidity is added."},{title:"Allowance Management",detail:"If a provider approves unlimited WETH and forgets to set/clear commitments, the router could still pull funds for flash loans. The UI defaults to “Unlimited” but makes the commitment explicit to mitigate confusion."},{title:"Borrower DoS",detail:"Large flash loans could still revert if the borrower’s downstream call fails. This is inherent to flash loans; downstream contracts must be carefully audited."}],f=[{title:"Arithmetic Overflow",threat:"Unlimited commitments multiplied by pool percentages could overflow and allow an attacker to bypass per-loan caps.",mitigation:"Router now uses Math.mulDiv(totalCommitted, maxBorrowBps, 10_000). Unlimited commitments stay safe and max borrow logic cannot be bypassed."},{title:"Liquidity Theft via Demo Borrower",threat:"A malicious demo borrower could try to keep the flash loaned ETH and return nothing.",mitigation:"Router enforces repayment. The fail demo contract intentionally withholds funds to prove the FlashLoanFailed revert path."},{title:"Front-running & MEV",threat:"Attackers may front-run profitable loans or grief providers.",mitigation:"Fees are clamped low, max borrow percentages distribute fills across multiple providers, and operators can use private RPC/MEV protection when necessary."}];function j(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l(),{children:[(0,r.jsx)("title",{children:"Security Audit \xb7 FlashBank Router"}),(0,r.jsx)("meta",{name:"description",content:"Security posture of the FlashBank Router (WETH-first architecture)"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,r.jsx)("header",{className:"bg-white border-b border-gray-200",children:(0,r.jsxs)("div",{className:"container mx-auto px-6 py-4 flex justify-between items-center",children:[(0,r.jsxs)(n(),{href:"/",className:"flex items-center space-x-2 text-blue-600 hover:text-blue-800",children:[(0,r.jsx)(o.Z,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"font-medium",children:"Back to App"})]}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"Last reviewed: November 2025"})]})}),(0,r.jsx)("main",{className:"py-12",children:(0,r.jsxs)("div",{className:"container mx-auto px-6 max-w-5xl space-y-12",children:[(0,r.jsxs)("section",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,r.jsx)(o.Z,{className:"h-10 w-10 text-blue-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"FlashBank Router Security Review"}),(0,r.jsx)("p",{className:"text-gray-600",children:"WETH-first, wallet-custodied liquidity \xb7 Internal audit + automated tests"})]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-3 mb-6",children:[(0,r.jsxs)("span",{className:"px-4 py-2 bg-yellow-100 text-yellow-800 rounded-lg flex items-center text-sm font-medium",children:[(0,r.jsx)(d.Z,{className:"h-4 w-4 mr-2"})," Self-audited (external review pending)"]}),(0,r.jsxs)("span",{className:"px-4 py-2 bg-green-100 text-green-800 rounded-lg flex items-center text-sm font-medium",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4 mr-2"})," 62 automated security tests"]}),(0,r.jsxs)("span",{className:"px-4 py-2 bg-blue-100 text-blue-800 rounded-lg flex items-center text-sm font-medium",children:[(0,r.jsx)(m.Z,{className:"h-4 w-4 mr-2"})," Non-upgradeable \xb7 Owner cannot move user funds"]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,r.jsxs)("a",{href:"https://github.com/flashbank-net/flashbank/blob/main/contracts/FlashBankRouter.sol",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800",children:[(0,r.jsx)(x.Z,{className:"h-4 w-4 mr-2"})," Source (FlashBankRouter.sol)",(0,r.jsx)(h.Z,{className:"h-3 w-3 ml-2"})]}),(0,r.jsxs)("a",{href:"https://sepolia.etherscan.io/address/".concat("0x3E17aDAd1ec99F9cA0c767f06a02D047b3722D94","#code"),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,r.jsx)(h.Z,{className:"h-4 w-4 mr-2"})," Verified on Etherscan"]})]})]}),(0,r.jsxs)("section",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Key Safeguards"}),(0,r.jsx)("div",{className:"grid md:grid-cols-2 gap-6",children:p.map(e=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-5 bg-gray-50",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:e.title}),(0,r.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:e.detail})]},e.title))})]}),(0,r.jsxs)("section",{className:"space-y-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Critical Code Paths"}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"px-5 py-3 bg-gray-50 border-b border-gray-200 font-semibold text-gray-800",children:"Per-Token Config & Limits"}),(0,r.jsx)("div",{className:"p-5 bg-gray-900 text-gray-100 font-mono text-xs overflow-x-auto",children:(0,r.jsx)("pre",{children:"struct TokenConfig {\n    bool enabled;\n    bool supportsPermit;\n    uint16 feeBps;           // 0.01% – 1%\n    uint256 maxFlashLoan;    // absolute cap\n    address wrapper;         // WETH or native bridge\n    uint16 maxBorrowBps;     // % of pool borrowable in one tx\n}"})})]}),(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[(0,r.jsx)("div",{className:"px-5 py-3 bg-gray-50 border-b border-gray-200 font-semibold text-gray-800",children:"Flash Loan Guard"}),(0,r.jsx)("div",{className:"p-5 bg-gray-900 text-gray-100 font-mono text-xs overflow-x-auto",children:(0,r.jsx)("pre",{children:"uint256 maxBorrow = Math.mulDiv(\n    totalCommitted[token],\n    config.maxBorrowBps,\n    FEE_DENOMINATOR\n);\nif (amount > maxBorrow) revert ExceedsMaxBorrowLimit();"})})]})]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Unlimited commitments previously risked overflowing ",(0,r.jsx)("code",{children:"totalCommitted * maxBorrowBps"}),". We now calculate borrow caps with",(0,r.jsx)("code",{children:"Math.mulDiv"}),", ensuring the percentage guard holds for any pool size."]})]}),(0,r.jsxs)("section",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Recent Findings & Fixes"}),(0,r.jsx)("div",{className:"grid md:grid-cols-2 gap-6",children:g.map(e=>(0,r.jsxs)("div",{className:"border border-green-200 bg-green-50 rounded-lg p-5",children:[(0,r.jsxs)("div",{className:"text-xs uppercase tracking-wide text-green-700 font-semibold",children:[e.impact," impact"]}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-green-900 mt-1 mb-2",children:e.title}),(0,r.jsx)("p",{className:"text-sm text-green-800 leading-relaxed",children:e.detail})]},e.title))})]}),(0,r.jsxs)("section",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Attack Scenarios & Mitigations"}),(0,r.jsx)("div",{className:"space-y-4",children:f.map(e=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-5",children:[(0,r.jsxs)("div",{className:"flex items-start space-x-3 mb-2",children:[(0,r.jsx)(d.Z,{className:"h-5 w-5 text-red-600 flex-shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.title}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,r.jsx)("strong",{children:"Threat:"})," ",e.threat]})]})]}),(0,r.jsxs)("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 text-sm text-green-800",children:[(0,r.jsx)("strong",{children:"Mitigation:"})," ",e.mitigation]})]},e.title))})]}),(0,r.jsxs)("section",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Open Risks"}),(0,r.jsx)("div",{className:"space-y-4",children:b.map(e=>(0,r.jsxs)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-5",children:[(0,r.jsx)("h3",{className:"font-semibold text-yellow-900 mb-1",children:e.title}),(0,r.jsx)("p",{className:"text-sm text-yellow-800 leading-relaxed",children:e.detail})]},e.title))})]}),(0,r.jsxs)("section",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Testing & Verification"}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"border border-blue-200 bg-blue-50 rounded-lg p-6",children:[(0,r.jsx)("h3",{className:"font-semibold text-blue-900 mb-3",children:"Automated Coverage"}),(0,r.jsxs)("ul",{className:"space-y-2 text-sm text-blue-800",children:[(0,r.jsx)("li",{children:"✓ 62 Hardhat/Foundry tests"}),(0,r.jsx)("li",{children:"✓ Dedicated failure-path tests (FlashLoanFailed, paused router)"}),(0,r.jsx)("li",{children:"✓ Demo borrower integration tests"})]})]}),(0,r.jsxs)("div",{className:"border border-purple-200 bg-purple-50 rounded-lg p-6",children:[(0,r.jsx)("h3",{className:"font-semibold text-purple-900 mb-3",children:"Manual Review Checklist"}),(0,r.jsxs)("ul",{className:"space-y-2 text-sm text-purple-800",children:[(0,r.jsx)("li",{children:"✓ Verified bytecode on Etherscan"}),(0,r.jsx)("li",{children:"✓ Checked owner cannot drain WETH"}),(0,r.jsx)("li",{children:"✓ Ensured Math.mulDiv guards unlimited commitments"})]})]})]})]}),(0,r.jsxs)("section",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Bug Bounty & Contact"}),(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-lg p-8 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-700 mb-2",children:"Found something concerning? Please disclose responsibly."}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Critical issues are rewarded. Provide reproduction steps, impact analysis, and recommended fixes."})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("a",{href:"mailto:security@flashbank.net",className:"inline-flex items-center px-5 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-semibold",children:[(0,r.jsx)(u.Z,{className:"h-4 w-4 mr-2"})," Report Vulnerability"]}),(0,r.jsxs)("a",{href:"https://github.com/flashbank-net/flashbank/security",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-5 py-3 border border-gray-300 rounded-lg text-sm font-semibold text-gray-700 hover:bg-gray-50",children:[(0,r.jsx)(x.Z,{className:"h-4 w-4 mr-2"})," Security Policy"]})]})]})]})]})})]})]})}}},function(e){e.O(0,[9147,2888,9774,179],function(){return e(e.s=79058)}),_N_E=e.O()}]);